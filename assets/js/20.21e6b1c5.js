(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{425:function(v,_,t){"use strict";t.r(_);var l=t(21),a=Object(l.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h1",{attrs:{id:"浏览器导航"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#浏览器导航"}},[v._v("#")]),v._v(" 浏览器导航")]),v._v(" "),t("blockquote",[t("p",[v._v("从输入URL到获到HTML响应称为导航；"),t("br"),v._v("\n从请求网页到浏览器 "),t("em",[v._v("准备")]),v._v(" 渲染网页的过程，叫做导航；\n用户发出 URL 请求到页面 "),t("em",[v._v("开始")]),v._v(" 解析的这个过程，就叫做导航；\n可以理解为渲染阶段之前的过程；")])]),v._v(" "),t("p",[v._v("导航阶段主要涉及到一些进程之间的配合，如下：")]),v._v(" "),t("ol",[t("li",[t("strong",[v._v("浏览器进程")]),v._v(" ：用户交互、子进程管理和文件储存等功能")]),v._v(" "),t("li",[t("strong",[v._v("网络进程")]),v._v(" ：面向渲染进程和浏览器进程等提供网络下载功能")]),v._v(" "),t("li",[t("strong",[v._v("渲染进程")]),v._v(" ：把从网络下载的 HTML、JavaScript、CSS、图片等资源解析为可以显示和交互的页面")])]),v._v(" "),t("h2",{attrs:{id:"导航阶段的步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#导航阶段的步骤"}},[v._v("#")]),v._v(" 导航阶段的步骤")]),v._v(" "),t("h2",{attrs:{id:"处理输入"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#处理输入"}},[v._v("#")]),v._v(" 处理输入")]),v._v(" "),t("ol",[t("li",[v._v("浏览器进程处理整合输入信息为URL")]),v._v(" "),t("li",[v._v("触发 onbeforeunload 事件")]),v._v(" "),t("li",[v._v("将 URL 通过 IPC 转发给网络进程，tab页 显示旋转图标")]),v._v(" "),t("li",[v._v("优化策略\n"),t("ul",[t("li",[v._v("因为这时候已经知道url了，是否同一站点（相同的协议和根域名）")]),v._v(" "),t("li",[v._v("提前准备渲染进程（复用/开启新的）")]),v._v(" "),t("li",[v._v("发生了重定向，这个待命进程可能用不上")])])])]),v._v(" "),t("h2",{attrs:{id:"开始导航"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开始导航"}},[v._v("#")]),v._v(" 开始导航")]),v._v(" "),t("blockquote",[t("p",[v._v("http请求前的准备")])]),v._v(" "),t("ol",[t("li",[v._v("查找缓存\n"),t("ul",[t("li",[v._v("网络进程接收到 URL 后，查找请求缓存，如果有缓存返回资源副本，结束请求并返回200")])])]),v._v(" "),t("li",[v._v("准备IP和端口\n"),t("ul",[t("li",[v._v("DNS解析（浏览器DNS缓存、本地hosts文件、请求DNS服务）获取 IP")]),v._v(" "),t("li",[v._v("端口从url获取，如果没有指定（http默认80，https默认443）")])])]),v._v(" "),t("li",[v._v("等待 TCP队列\n"),t("ul",[t("li",[v._v("因为浏览器会限制单个域名最大 TCP连接 为6个，缓解服务器压力")])])]),v._v(" "),t("li",[v._v("建立TCP连接\n"),t("ul",[t("li",[v._v("三次握手")])])]),v._v(" "),t("li",[v._v("HTTPS 建立 TLS 连接\n"),t("ul",[t("li",[v._v("如果是 HTTPS 需要建立")])])]),v._v(" "),t("li",[v._v("构建请求报文，发送 HTTP 请求")]),v._v(" "),t("li",[v._v("服务器返回响应信息")])]),v._v(" "),t("h2",{attrs:{id:"读取响应"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#读取响应"}},[v._v("#")]),v._v(" 读取响应")]),v._v(" "),t("ol",[t("li",[v._v("判断状态码\n"),t("ul",[t("li",[v._v("301/302，告知浏览器进程，并根据 响应头的 Location 字段重新发起一个 URL 请求")]),v._v(" "),t("li",[v._v("200，导航继续")])])]),v._v(" "),t("li",[v._v("根据响应头中的 Content-Type 决定如何响应\n"),t("ul",[t("li",[v._v("字节流类型，交给浏览器下载管理器处理，导航结束")]),v._v(" "),t("li",[v._v("HTML类型，导航继续")]),v._v(" "),t("li",[v._v("网络进程发送响应头信息给浏览器进程")]),v._v(" "),t("li",[v._v("浏览器进程通知渲染进程准备渲染（也可能是在之前已经准备好了）")])])])]),v._v(" "),t("h2",{attrs:{id:"提交文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#提交文档"}},[v._v("#")]),v._v(" 提交文档")]),v._v(" "),t("ol",[t("li",[v._v("提交文档\n"),t("ul",[t("li",[v._v("浏览器进程接收到响应头，向渲染进程发送 "),t("strong",[v._v("提交文档")]),v._v(" 消息")])])]),v._v(" "),t("li",[v._v("建立管道\n"),t("ul",[t("li",[v._v("渲染进程接收到消息后，和网络进程建立数据管道，用来不间断传输HTML数据流（响应体）")])])]),v._v(" "),t("li",[v._v("确认提交\n"),t("ul",[t("li",[v._v("渲染进程接收完数据，返回 "),t("strong",[v._v("确认提交")]),v._v(" 的消息给浏览器进程")])])]),v._v(" "),t("li",[v._v("导航完成\n"),t("ul",[t("li",[v._v("浏览器进程接收到确认消息后，更新浏览器状态（地址栏、安全状态、前进后退、web页面，写入历史记录等）")]),v._v(" "),t("li",[v._v("至此，导航流程完成")])])])]),v._v(" "),t("h2",{attrs:{id:"初始加载完成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#初始加载完成"}},[v._v("#")]),v._v(" 初始加载完成")]),v._v(" "),t("p",[v._v("渲染进程发送 "),t("strong",[v._v("确认提交")]),v._v(" 后，就开始 "),t("strong",[v._v("解析页面")]),v._v(" 、 "),t("strong",[v._v("加载子资源")]),v._v("，完成渲染后通过IPC给浏览器进程发送一个消息。此时，浏览器进程停止标签页上的旋转图标。")]),v._v(" "),t("blockquote",[t("p",[v._v("初始加载完成后，客户端JavaScript仍然可能加载额外资源并重新渲染页面")])])])}),[],!1,null,null,null);_.default=a.exports}}]);
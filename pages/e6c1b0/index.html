<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>项目规范常用配置 | easyinmind</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="前端技术博客,干货,前端学习与总结。JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.c6f546a7.css" as="style"><link rel="preload" href="/assets/js/app.e9ca8c87.js" as="script"><link rel="preload" href="/assets/js/2.60fa7d2d.js" as="script"><link rel="preload" href="/assets/js/25.d6f86ce8.js" as="script"><link rel="prefetch" href="/assets/js/10.28bccf81.js"><link rel="prefetch" href="/assets/js/11.8c02035d.js"><link rel="prefetch" href="/assets/js/12.b2a503be.js"><link rel="prefetch" href="/assets/js/13.ce8fa3a7.js"><link rel="prefetch" href="/assets/js/14.eac5bd40.js"><link rel="prefetch" href="/assets/js/15.095e9da7.js"><link rel="prefetch" href="/assets/js/16.5a484c9d.js"><link rel="prefetch" href="/assets/js/17.04e9a84d.js"><link rel="prefetch" href="/assets/js/18.c7f5f16b.js"><link rel="prefetch" href="/assets/js/19.6b712fc4.js"><link rel="prefetch" href="/assets/js/20.0c9bb1b5.js"><link rel="prefetch" href="/assets/js/21.0f5b1587.js"><link rel="prefetch" href="/assets/js/22.a8884498.js"><link rel="prefetch" href="/assets/js/23.4a94aeda.js"><link rel="prefetch" href="/assets/js/24.d9a8a94d.js"><link rel="prefetch" href="/assets/js/26.2f653999.js"><link rel="prefetch" href="/assets/js/27.0cad2ac4.js"><link rel="prefetch" href="/assets/js/28.f5a7b7e9.js"><link rel="prefetch" href="/assets/js/29.98cff323.js"><link rel="prefetch" href="/assets/js/3.6eb2a58a.js"><link rel="prefetch" href="/assets/js/30.542b23fc.js"><link rel="prefetch" href="/assets/js/4.75bcf19e.js"><link rel="prefetch" href="/assets/js/5.55c4a00e.js"><link rel="prefetch" href="/assets/js/6.ba3dd45d.js"><link rel="prefetch" href="/assets/js/7.f0370d72.js"><link rel="prefetch" href="/assets/js/8.f6479d16.js"><link rel="prefetch" href="/assets/js/9.73f9c98a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c6f546a7.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open no-sidebar have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://cdn.jsdelivr.net/gh/easyinmind/cdn_file/blog/blog-photo.jpg" alt="easyinmind" class="logo"> <span class="site-name can-hide">easyinmind</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于我</a></div><div class="nav-item"><a href="/pages/bjdct/" class="nav-link">北京的春天</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/easyinmind/cdn_file/blog/1024x1024.jpg"> <div class="blogger-info"><h3>DBY</h3> <span>学无止境</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于我</a></div><div class="nav-item"><a href="/pages/bjdct/" class="nav-link">北京的春天</a></div> <!----></nav>  <!----> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-33863c7e><div class="articleInfo" data-v-33863c7e><ul class="breadcrumbs" data-v-33863c7e><li data-v-33863c7e><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-33863c7e></a></li> <li data-v-33863c7e><a href="/categories/?category=%E6%8A%80%E6%9C%AF" title="分类" data-v-33863c7e>技术</a></li> <li data-v-33863c7e><a href="/categories/?category=%E5%89%8D%E7%AB%AF" title="分类" data-v-33863c7e>前端</a></li> <!----></ul> <div class="info" data-v-33863c7e><div title="作者" class="author iconfont icon-touxiang" data-v-33863c7e><a href="javascript:;" data-v-33863c7e>dby</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-33863c7e><a href="javascript:;" data-v-33863c7e>2021-01-12</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><!----> <h1><!---->
          项目规范常用配置
        </h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="配置git-message规范工具"><a href="#配置git-message规范工具" class="header-anchor">#</a> 配置git message规范工具</h2> <h2 id="git-交互工具"><a href="#git-交互工具" class="header-anchor">#</a> git 交互工具</h2> <blockquote><p>安装 git commit消息工具 <code>commitizen</code></p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm i commitizen -D  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>commitizen</code> 是格式化commit message的工具，提供的 git cz 命令替代 git commit 命令，需要结合适配器使用。</p> <h2 id="使用-angular-规范的-预设cz-conventional-changelog"><a href="#使用-angular-规范的-预设cz-conventional-changelog" class="header-anchor">#</a> 使用 angular 规范的 预设<code>cz-conventional-changelog</code></h2> <blockquote><p>(还有其它适配器，注意：不同的适配器 具有不同的界面、规范、配置方式)</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>commitizen init cz-conventional-changelog --save-dev --save-exact
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这里命令做了三件事(或者不使用 commitizen init，手动安装并配置也可以。)</p> <ol><li>在项目中安装cz-conventional-changelog 适配器依赖</li> <li>将适配器依赖保存到package.json的devDependencies字段信息</li> <li>在package.json中新增config.commitizen字段信息，主要用于配置cz工具的适配器路径</li></ol> <div class="language-json line-numbers-mode"><pre class="language-json"><code>  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;cz-conventional-changelog&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.3.0&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;commitizen&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./node_modules/cz-conventional-changelog&quot;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>需要注意的一点是在初始化适配器之前运行 <code>npx git cz</code>，与初始化之后运行效果相同，命令行上展示了使用的适配器</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npx git cz
cz-cli@4.2.2, cz-conventional-changelog@3.3.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>猜测是 commitizen(&quot;^4.2.2&quot;) 默认设置了适配器，查阅源码，在 <code>node_modules/commitizen/dist/cli/git-cz.js</code>里发现默认配置</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token parameter">environment <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> argv <span class="token operator">=</span> process<span class="token punctuation">.</span>argv</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Get cli args</span>
  <span class="token keyword">let</span> rawGitArgs <span class="token operator">=</span> argv<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> argv<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> adapterConfig <span class="token operator">=</span> environment<span class="token punctuation">.</span>config <span class="token operator">||</span> _commitizen<span class="token punctuation">.</span>configLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'cz-conventional-changelog'</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> _strategies<span class="token punctuation">.</span>gitCz<span class="token punctuation">)</span><span class="token punctuation">(</span>rawGitArgs<span class="token punctuation">,</span> environment<span class="token punctuation">,</span> adapterConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="git-校验工具"><a href="#git-校验工具" class="header-anchor">#</a> git 校验工具</h2> <blockquote><p>配置 commit message 校验工具
这样配置完成后方便了书写commit message， 但是书写的是否符合标准，就需要一个lint工具进行校验了</p></blockquote> <p><code>commitlint</code> 可以lint commit message。如果提交的不符合指向的规范，会拒绝提交。这个工具也需要一份校验配置，可以使用也符合 Angular团队规范 <code>@commitlint/config-conventional</code></p> <p>安装并配置文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install --save-dev @commitlint/config-conventional @commitlint/cli

echo &quot;module.exports = {extends: ['@commitlint/config-conventional']}&quot; &gt; commitlint.config.js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这个校验需要在commit message提交前，利用 git hooks触发。
git 在 commit的时候后会按顺序触发 pre-commit、prepare-commit-msg、commit-msg、post-commit。可以在 commit-msg的时候进行校验
安装 <code>husky</code>，配置文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install husky --save-dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// husky.config.js </span>
<span class="token keyword">const</span> hooks <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">'commit-msg'</span><span class="token operator">:</span> <span class="token string">'commitlint -E HUSKY_GIT_PARAMS'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  hooks
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>npm 安装 husky 的时候，husky 会在项目的.git/hooks文件夹下创建所有支持的hooks（node husky install）
husky 简单来说 让git hooks变得简单，提交的时候会从 package.json、.huskyrc、.huskyrc.json 中获取相应的 hook 配置。或者手动在 <code>.git/hook/</code> 目录里改写hook模板文件</p> <h2 id="git-命令替换"><a href="#git-命令替换" class="header-anchor">#</a> git 命令替换</h2> <blockquote><p>配置 git commit 替换 git cz，根据习惯决定是否配置
使用git commit 触发 <code>prepare-commit-msg</code> 这个钩子的时候调用 git cz，这样在使用的时候直接 git commit就可以了，符合日常提交方式</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> platform <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> isWindow <span class="token operator">=</span> <span class="token function">platform</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'win32'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> hooks <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">'commit-msg'</span><span class="token operator">:</span> <span class="token string">'commitlint -E HUSKY_GIT_PARAMS'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// window 环境不支持</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isWindow<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  hooks<span class="token punctuation">[</span><span class="token string">'prepare-commit-msg'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'exec &lt; /dev/tty &amp;&amp; git cz --hook || true'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  hooks
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="代码规范及格式"><a href="#代码规范及格式" class="header-anchor">#</a> 代码规范及格式</h2> <blockquote><p>配置 eslint 及 pretter</p></blockquote> <p>如果使用eslint-loader在webpack构建的时候校验，代码量较大的时候耗时太长了。这里配置的 eslint 放在代码提交的时候进行 lint，保证提交的代码质量。至于在开发阶段可以在 vscode 中配置插件来获取提示信息。</p> <p>eslint、stylelint、pretter校验文件的区别</p> <ul><li>eslint：js、ts、jsx、tsx</li> <li>stylelint：css、less、scss……</li> <li>pretter：包含eslint、stylelint及html、md</li></ul> <p>在格式化代码方面， Prettier 确实和 ESLint 有重叠，但两者侧重点不同：ESLint 主要工作就是检查代码质量并给出提示，它所能提供的格式化功能很有限；而 Prettier 在格式化代码方面具有更大优势。所幸，Prettier 被设计为易于与 ESLint 集成，所以你可以轻松在项目中使两者，而无需担心冲突</p> <p>安装Eslint pretter</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm i eslint prettier -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>初始化 eslint <code>npx eslint init</code><br>
选择 problems、esm、ts、react、browser</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// .eslintrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  env<span class="token operator">:</span> <span class="token punctuation">{</span>
    browser<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    es2021<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;eslint:recommended&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;plugin:react/recommended&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;plugin:@typescript-eslint/recommended&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  parser<span class="token operator">:</span> <span class="token string">&quot;@typescript-eslint/parser&quot;</span><span class="token punctuation">,</span>
  parserOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
    ecmaFeatures<span class="token operator">:</span> <span class="token punctuation">{</span>
      jsx<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    ecmaVersion<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    sourceType<span class="token operator">:</span> <span class="token string">&quot;module&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;@typescript-eslint&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  rules<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>配置 prettier 的配置文件</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// prettierrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  printWidth<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token comment">//一行的字符数，如果超过会进行换行，默认为80</span>
  tabWidth<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">//一个tab代表几个空格数，默认为80</span>
  useTabs<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//是否使用tab进行缩进，默认为false，表示用空格进行缩减</span>
  singleQuote<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//字符串是否使用单引号，默认为false，使用双引号</span>
  semi<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//行位是否使用分号，默认为true</span>
  trailingComma<span class="token operator">:</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">,</span> <span class="token comment">//是否使用尾逗号，有三个可选值&quot;&lt;none|es5|all&gt;&quot;</span>
  bracketSpacing<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//对象大括号直接是否有空格，默认为true，效果：{ foo: bar }</span>
  parser<span class="token operator">:</span> <span class="token string">&quot;babylon&quot;</span><span class="token punctuation">,</span> <span class="token comment">//代码的解析引擎，默认为babylon，与babel相同。</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>如何结合eslint prettier<br>
ESLint 和 Prettier 相互合作的时候有一些问题，对于他们交集的部分规则，ESLint 和 Prettier 格式化后的代码格式不一致。导致的问题是：当你用 Prettier 格式化代码后再用 ESLint 去检测，会出现一些因为格式化导致的 warning，当你用eslint --fix修复问题，又无法通过Prettier校验，导致陷入一开始提到的“死循环问题”。
这种问题的主要解决思路是在 ESLint 的规则配置文件上做文章，安装特定的 plugin，把其配置到规则的尾部，实现 Prettier 规则对 ESLint 规则的覆盖。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install --save-dev eslint-config-prettier
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;eslint:recommended&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;plugin:react/recommended&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;plugin:@typescript-eslint/recommended&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;prettier&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;prettier/@typescript-eslint&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>extends的值为数组，会继承和覆盖前面的配置，将Prettier配置添加到其它拓展的后面，可以实现 Prettier 规则对 ESLint 规则的覆盖。
完成上述两步可以实现的是运行 ESLint 命令会按照 Prettier 的规则做相关校验，但是还是需要运行 Prettier 命令来进行格式化。为了避免多此一举，万能的社区早就提出了整合上面两步的方案：在使用 eslint --fix 时候，实际使用 Prettier 来替代 ESLint 的格式化功能。如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 安装eslint-plugin-prettier</span>
npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev eslint<span class="token operator">-</span>plugin<span class="token operator">-</span>prettier

<span class="token comment">// 在 .eslintrc.js 文件里面的 extends 字段添加：</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token operator">...</span><span class="token punctuation">,</span>
    <span class="token string">&quot;已经配置的规则&quot;</span><span class="token punctuation">,</span>
<span class="token operator">+</span>   <span class="token string">&quot;plugin:prettier/recommended&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">&quot;rules&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;prettier/prettier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>这个时候你运行 eslint --fix 实际使用的是 Prettier 去格式化文件。在rules中添加&quot;prettier/prettier&quot;: &quot;error&quot;，当代码出现Prettier校验出的格式化问题，ESLint会报错</p> <p>在git commit之前pre-commit这个钩子执行的时候去校验比较合适，这里有个问题就是每次都会去校验所有的文件，可以通过 <code>lint-staged</code> 解决<br> <code>lint-staged</code> 识别被加入到stage区文件，每次只对当前修改后的文件进行扫描，即进行git add加入到stage区的文件进行扫描即可，完成对增量代码进行检查</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install -D lint-staged
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>增加配置</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// husky.config.js</span>
<span class="token string">'pre-commit'</span><span class="token operator">:</span> <span class="token string">'lint-staged'</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// package.json</span>
<span class="token property">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;src/**/*.{js,vue}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;prettier --write&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;eslint --cache --fix&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;git add&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>在进行git commit的时候会触发到git hook进而执行precommit，而precommit脚本引用了lint-staged配置表明只对git add到 stage 区的文件进行扫描，具体lint-staged做了三件事情：</p> <ul><li>执行Prettier脚本，这是对代码进行格式化的;</li> <li>执行eslint --fix操作，进行扫描，对eslint问题进行修复；</li> <li>上述两项任务完成后将代码重新add进 stage 区，然后执行commit。(&quot;git add&quot;可加可不加，具体看情况而定)</li></ul> <h2 id="翻译及配置-cz-conventional-changelog"><a href="#翻译及配置-cz-conventional-changelog" class="header-anchor">#</a> 翻译及配置 cz-conventional-changelog</h2> <p>新建 <code>.cz.json</code> 配置中文字段,
修改配置路径为本地维护包，并调整包内英文</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;path&quot;: &quot;./scripts/cz-conventional-changelog&quot;,
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">更新于:</span> <span class="time">2023/11/30</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/967ed7/"><div>preload&amp;prefetch</div></a> <span>09-23</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/2f93fe/"><div>webpack 概念</div></a> <span>09-04</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/d17ca6/"><div>项目基于Jenkins发版流程</div></a> <span>08-10</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2023
    <span>DBY</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e9ca8c87.js" defer></script><script src="/assets/js/2.60fa7d2d.js" defer></script><script src="/assets/js/25.d6f86ce8.js" defer></script>
  </body>
</html>
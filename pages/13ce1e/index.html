<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack项目配置相关 | easyinmind</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="前端技术博客,干货,前端学习与总结。JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.c6f546a7.css" as="style"><link rel="preload" href="/assets/js/app.e9ca8c87.js" as="script"><link rel="preload" href="/assets/js/2.60fa7d2d.js" as="script"><link rel="preload" href="/assets/js/13.ce8fa3a7.js" as="script"><link rel="prefetch" href="/assets/js/10.28bccf81.js"><link rel="prefetch" href="/assets/js/11.8c02035d.js"><link rel="prefetch" href="/assets/js/12.b2a503be.js"><link rel="prefetch" href="/assets/js/14.eac5bd40.js"><link rel="prefetch" href="/assets/js/15.095e9da7.js"><link rel="prefetch" href="/assets/js/16.5a484c9d.js"><link rel="prefetch" href="/assets/js/17.04e9a84d.js"><link rel="prefetch" href="/assets/js/18.c7f5f16b.js"><link rel="prefetch" href="/assets/js/19.6b712fc4.js"><link rel="prefetch" href="/assets/js/20.0c9bb1b5.js"><link rel="prefetch" href="/assets/js/21.0f5b1587.js"><link rel="prefetch" href="/assets/js/22.a8884498.js"><link rel="prefetch" href="/assets/js/23.4a94aeda.js"><link rel="prefetch" href="/assets/js/24.d9a8a94d.js"><link rel="prefetch" href="/assets/js/25.d6f86ce8.js"><link rel="prefetch" href="/assets/js/26.2f653999.js"><link rel="prefetch" href="/assets/js/27.0cad2ac4.js"><link rel="prefetch" href="/assets/js/28.f5a7b7e9.js"><link rel="prefetch" href="/assets/js/29.98cff323.js"><link rel="prefetch" href="/assets/js/3.6eb2a58a.js"><link rel="prefetch" href="/assets/js/30.542b23fc.js"><link rel="prefetch" href="/assets/js/4.75bcf19e.js"><link rel="prefetch" href="/assets/js/5.55c4a00e.js"><link rel="prefetch" href="/assets/js/6.ba3dd45d.js"><link rel="prefetch" href="/assets/js/7.f0370d72.js"><link rel="prefetch" href="/assets/js/8.f6479d16.js"><link rel="prefetch" href="/assets/js/9.73f9c98a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c6f546a7.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open no-sidebar have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://cdn.jsdelivr.net/gh/easyinmind/cdn_file/blog/blog-photo.jpg" alt="easyinmind" class="logo"> <span class="site-name can-hide">easyinmind</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于我</a></div><div class="nav-item"><a href="/pages/bjdct/" class="nav-link">北京的春天</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/easyinmind/cdn_file/blog/1024x1024.jpg"> <div class="blogger-info"><h3>DBY</h3> <span>学无止境</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于我</a></div><div class="nav-item"><a href="/pages/bjdct/" class="nav-link">北京的春天</a></div> <!----></nav>  <!----> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-33863c7e><div class="articleInfo" data-v-33863c7e><ul class="breadcrumbs" data-v-33863c7e><li data-v-33863c7e><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-33863c7e></a></li> <li data-v-33863c7e><a href="/categories/?category=%E6%8A%80%E6%9C%AF" title="分类" data-v-33863c7e>技术</a></li> <li data-v-33863c7e><a href="/categories/?category=%E5%89%8D%E7%AB%AF" title="分类" data-v-33863c7e>前端</a></li> <!----></ul> <div class="info" data-v-33863c7e><div title="作者" class="author iconfont icon-touxiang" data-v-33863c7e><a href="javascript:;" data-v-33863c7e>dby</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-33863c7e><a href="javascript:;" data-v-33863c7e>2021-01-12</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><!----> <h1><!---->
          webpack项目配置相关
        </h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="webpack"><a href="#webpack" class="header-anchor">#</a> webpack</h2> <p>基于webpack5 + react hooks + ts + less 项目搭建流程</p> <p>搭建过程中会描述各项配置的作用，以及一些常用点的讲解</p> <h2 id="一、安装-webpack-及-webpack-cli"><a href="#一、安装-webpack-及-webpack-cli" class="header-anchor">#</a> 一、安装 <code>webpack</code> 及 <code>webpack-cli</code></h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm i webpack webpack-cli -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>可以全局安装-G，建议安装在项目内（不同项目版本可能有区别，减少对项目的影响）</p> <p>默认配置：</p> <ul><li>入口：<code>src/index.js</code></li> <li>出口：<code>dist/main.js</code></li> <li>mode： <code>production</code> (开启压缩和优化)</li></ul> <p>运行：<code>npx webpack</code> node v8.2版本以后都会有一个npx，npx会执行bin里的文件（webpack）</p> <p>关于 <code>mode</code>：</p> <p>默认值： <code>production</code></p> <p>设置mode可以改变 process.env.NODE_ENV 的值</p> <p>配置文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = {
  mode: 'production'
};
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>命令行</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>webpack --mode=production
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>development： 会将 DefinePlugin 中 process.env.NODE_ENV 的值设置为 development. 为模块和 chunk 启用有效的名（会开启一些插件）</li> <li>production：会将 DefinePlugin 中 process.env.NODE_ENV 的值设置为 production 。为模块和 chunk 启用确定性的混淆名称，并开启其它的一些生产环境的优化（会开启一些插件）</li> <li>none：不使用任何默认优化选项</li> <li>不同 mode 对应的配置、插件可查看文档</li></ul> <p>关于 <code>context</code> 上下文:</p> <p>默认值是 <code>process.cwd()</code> （当前node执行的文件夹地址），推荐将 context 修改为项目的根目录，这样可以使得项目配置独立于CWD</p> <p>context 是 webpack 编译时的基础目录，是一个绝对路径的字符串，context 用于解析配置中的entry、loader、plugins中的相对路径（除了output），配置方式同 <code>mode</code> 参数</p> <h2 id="二、增加配置文件"><a href="#二、增加配置文件" class="header-anchor">#</a> 二、增加配置文件</h2> <p>默认运行 <code>webpack</code> 会去查找 webpack.congif.js 配置文件，如果没有这个文件会使用默认值，可以通过如下方式指定配置文件：</p> <p>命令行（推荐这种方式）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>webpack --config xxx.js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>或者在 webpack.congif.js 通过环境变量指定配置</p> <h2 id="三、配置入口-enry-及出口-output"><a href="#三、配置入口-enry-及出口-output" class="header-anchor">#</a> 三、配置入口（<code>enry</code>）及出口（<code>output</code>）</h2> <p>命令行</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>webpack 入口 出口
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>配置文件</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 单入口 =&gt; 单输出（一个chunk，SPA）</span>
  entry<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> 
  <span class="token comment">// 多入口 =&gt; 单输出（一个chunk， SPA）</span>
  entry<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
  <span class="token comment">// 多入口 =&gt; 多输出（多个chunk， MPA）</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
  

  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// entry 里的输出文件名</span>
    filename<span class="token operator">:</span> <span class="token string">&quot;[name].min.js&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// 非entry 里的输出文件名</span>
    chunkFilename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    <span class="token comment">// 输出的文件目录</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;/dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 个人理解，文件引用的前缀（如： 设置为CDN地址等）</span>
    publicPath<span class="token operator">:</span> <span class="token string">'./'</span><span class="token punctuation">,</span> 
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>这里涉及到一些 chunk 及 占位符的概念，后面会讲到</p> <h2 id="四、配置样式相关的-loader"><a href="#四、配置样式相关的-loader" class="header-anchor">#</a> 四、配置样式相关的 loader</h2> <p>webpack 默认识别js文件，但不认识css、less等文件，所以需要使用一些loader进行处理，这里不写loader的基础配置（具体配置可查看配置文件或文档），只关心一些常用配置点和注意</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm i style-loader css-loader less less-loader postcss postcss-loader -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p><code>less-loader sass-loader stylus-loader postcss-loader</code> 等css预处理器loader需要安装对应的预处理器 <code>less sass stylus postcss</code></p></li> <li><p><code>less-loader</code> 支持less文件</p></li> <li><p><code>postcss-loader</code></p> <ul><li>放在 预编译器之后，css-loader之前执行</li> <li>可以使用配置文件</li> <li>通过插件增加浏览器前缀，postcss-preset-env 包含 autoprefixer</li></ul></li> <li><p><code>css-loader</code> 用来处理@import、url()语法（把 css 代码打包进 js 文件而已，并不做任何操作）</p> <ul><li>modules css模块化配置</li> <li>importLoaders css-loader 之前有多少 loader 应用于@import</li></ul></li> <li><p><code>style-loader</code> 将css插入dom中</p></li></ul> <h2 id="四、配置图片及字体文件相关-loader"><a href="#四、配置图片及字体文件相关-loader" class="header-anchor">#</a> 四、配置图片及字体文件相关 loader</h2> <p>支持图片、字体等文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm i url-loader -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>url-loader 功能类似于 file-loader，增加了 <code>limit</code> 属性，可以设置返回 DataURL，用来减少http请求。这两个使用一个即可</p> <h2 id="五、配置-babel-支持-es6-jsx-ts"><a href="#五、配置-babel-支持-es6-jsx-ts" class="header-anchor">#</a> 五、配置 babel 支持 ES6, JSX, TS</h2> <p>主要是babel相关的用法，配置可参考项目内，babel更多详细内容 会另写一篇文章</p> <ul><li>babel 一些概念，核心包、预设、插件等</li> <li>babel 和 webpack 的区别</li> <li>babel-runtime、polyfil</li> <li>自定义插件</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm i babel-loader @babel/core @babel/preset-env @babel/preset-react @babel/preset-typescript -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>配置 <code>tsconfig.json</code></p> <h2 id="六、配置本地开发环境-webpack-dev-serve"><a href="#六、配置本地开发环境-webpack-dev-serve" class="header-anchor">#</a> 六、配置本地开发环境 webpack-dev-serve</h2> <p>如果不进行文件监听配置，在本地开发环境下，每次修改代码都需要手动打包刷新浏览器，常用本地开发配置主要通过下面几种方式：</p> <ul><li><p>watch监听 <code>webpack --watch</code><br>
开启这个配置会监听文件配置，自动打包（需要手动刷新浏览器、通过file协议访问）</p></li> <li><p>通过 webpack-dev-server + devServer</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm i webpack-dev-server
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>通过 webpack-dev-middleware + 自定义node服务配置<br>
自己写一个webpack-dev-server</p></li></ul> <p>通常使用 webpack-dev-server，使用本地服务方式，打包文件放在了内存中，提升速度，并且可以使用 ajax请求数据，代理接口</p> <p>关于 <code>HMR</code><br>
配置插件 <code>webpack.HotModuleReplacementPlugin()</code>及 devServer.hot 开启，需要增加自定义代码，开启热更新有代价，依据情况选择</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">'./print.js'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//  执行需要更新的代码</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>更多关于本地开发环境的配置，单独进行总结</p> <h2 id="七、安装相关插件"><a href="#七、安装相关插件" class="header-anchor">#</a> 七、安装相关插件</h2> <ul><li>html-webpack-plugin 生成HTML，并插入资源</li> <li>clean-webpack-plugin 删除output的输出目录内容</li> <li>mini-css-extract-plugin 提取css</li> <li>optimize-css-assets-webpack-plugin 压缩css</li> <li>terser-webpack-plugin 使用 terser 来压缩 JavaScript，（production 默认开启）</li></ul> <h2 id="八、区分环境"><a href="#八、区分环境" class="header-anchor">#</a> 八、区分环境</h2> <blockquote><ol><li>使用脚本命令指定不同的配置文件</li> <li>通过脚本传入不同的环境变量，在同一个配置文件内进行判断</li></ol></blockquote> <ul><li>配置npm script</li> <li>webpack-merge 拆分</li></ul></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">更新于:</span> <span class="time">2023/11/30</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/967ed7/"><div>preload&amp;prefetch</div></a> <span>09-23</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/2f93fe/"><div>webpack 概念</div></a> <span>09-04</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/d17ca6/"><div>项目基于Jenkins发版流程</div></a> <span>08-10</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2023
    <span>DBY</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e9ca8c87.js" defer></script><script src="/assets/js/2.60fa7d2d.js" defer></script><script src="/assets/js/13.ce8fa3a7.js" defer></script>
  </body>
</html>
---
title: preload&prefetch
date: 2021-09-23 11:19:07
permalink: /pages/967ed7/
categories:
  - 前端技术
tags:
  - 
---

## preload
+ 专注于当前页面，高优先级加载资源
+ 最好使用 preload 来加载你最重要的资源。
+ 不要与浏览器预加载混淆，浏览器预加载只预先加载在HTML中声明的资源。preload允许预加载在 CSS 和JavaScript 中定义的资源，并允许决定何时应用每个资源
+ 并不会阻塞window.onload事件
+ 兼容稍差
+ 如果通过 preload 加载了资源，3s内但是又没有使用它，则浏览器会报一个警告

> preload 除了能够预加载脚本之外，还可以通过 as 指定别的资源类型。style、script、font、image、audio、video、document


```html
<!-- 这里只是提前加载，并不会执行 -->
<link rel="preload" as="script" href="./main.js">
<!-- 这里才会执行 -->
<script src="./main.js"></script>

<!-- 分割线 -->

<!-- 加载顺序main1 => main2 -->
<script src="./main1.js"></script>
<script src="./main2.js"></script>

<!-- 加载顺序main2 => main1 -->
<link rel="preload" as="script" href="./main2.js">

<script src="./main1.js"></script>
<script src="./main2.js"></script>
```
## preload 场景
> 主要用于提升当前页面某些阻塞资源的下载优先级，使得页面能够尽快渲染显示出来

+ 预加载定义在 CSS 中资源的下载，比如自定义字体
+ 预加载 CSS 文件
+ 创建动态的预加载资源
+ 结合 Webpack 预加载 JS 模块



## prefetch
> prefetch 则是用于加载未来（比如下一个页面）会用到的资源，并且告诉浏览器在空闲的时候去下载，它会将下载资源的优先级降到最低


+ 专注于下个页面，低优先级加载资源
+ 浏览器在后台（空闲时）获取将来可能用得到的资源，并且将他们存储在浏览器的缓存中
+ 兼容还可以

## preconnect
> 当我们的站点需要对别的域下的资源进行请求的时候，就需要和那个域建立连接，然后才能开始下载资源。

```html
<link rel="preconnect" href="https://b.com">
```
通过 preconnect 提早建立和第三方源的连接

应用场景
+ 当知道资源是来源于哪个源下，但是对于加载哪个资源不是很明确的时候
+ 如果页面上有流媒体，但是没那么快播放，又希望当按下播放按钮的时候可以越快开始越好